<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø³ÙŠÙØ±Ø§Øª</title>

<style>
:root {
  --bg:#0f1724;--card:#0b1220;--txt:white;--accent:#01c38d;--glass:rgba(255,255,255,0.04)
}
body {
  background:var(--bg);
  font-family:"Tajawal",sans-serif;
  margin:0;padding:20px;color:var(--txt)
}
.container{max-width:600px;margin:auto}
.search-box {
  background:var(--glass);
  border:1px solid #1e293b;
  padding:12px;
  border-radius:10px;
  margin-bottom:20px;
  display:flex;
  gap:10px
}
input {
  flex:1;
  background:none;
  border:none;
  color:var(--txt);
  padding:10px;
  outline:none;
}
.card {
  background:var(--card);
  padding:15px;
  border-radius:12px;
  margin:10px 0;
  border:1px solid #1f2a3a;
  transition:0.25s
}
.card:hover { border-color:var(--accent) }
a { color:var(--accent); text-decoration:none }
.version { color:#8ef; font-size:14px }
</style>
</head>

<body>
<div class="container">
  <h2>ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø³ÙŠÙØ±Ø§Øª</h2>

  <div class="search-box">
    <input id="searchInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø±Ø³ÙŠÙØ±...">
  </div>

  <div id="results"></div>
</div>

<script>
const SHEET_ID = "1fvlOESmcjdE1DaiivSe8FB_pMp85MWzOajS9OWRzmow";
const SHEETS = ["Sheet3"]; // Ø¹Ø¯Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯Ù‡Ø§
let allDevices = [];

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¥ØµØ¯Ø§Ø± ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
function parseURLData(url) {
  if (!url) return { version: "-", releaseDate: "-" };

  let versionMatch = url.match(/V(\d+(?:\.\d+)?)/i);
  let version = versionMatch ? "V" + versionMatch[1] : "-";

  let dateMatch = url.match(/(\d{8})/);
  let releaseDate = "-";
  if (dateMatch) {
    let d = dateMatch[1];
    releaseDate = `${d.slice(0,2)}/${d.slice(2,4)}/${d.slice(4,8)}`;
  }

  return { version, releaseDate };
}

// Ù‚Ø±Ø§Ø¡Ø© CSV ÙˆØªØ­ÙˆÙŠÙ„Ù‡ Ù„Ù…ØµÙÙˆÙØ© JSON
function csvToArray(str) {
  let rows = str.split("\n").map(r => r.split(","));
  let headers = rows[0];
  return rows.slice(1).map(row => {
    let item = {};
    headers.forEach((h,i)=> item[h]=row[i]);
    const extra = parseURLData(item.url);
    item.version = extra.version;
    item.date = extra.releaseDate;
    return item;
  });
}

// Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ÙƒÙ„ ÙˆØ±Ù‚Ø©
async function fetchSheets() {
  for (let sheet of SHEETS) {
    let url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${sheet}`;
    let res = await fetch(url);
    let csv = await res.text();
    allDevices.push(...csvToArray(csv));
  }
  showResults(allDevices);
}

fetchSheets();

// Ø¨Ø­Ø« Ø­ÙŠ
document.getElementById("searchInput").addEventListener("input", ()=>{
  let q = searchInput.value.trim().toLowerCase();
  let filtered = allDevices.filter(d =>
    (d.name || "").toLowerCase().includes(q)
  );
  showResults(filtered);
});

// Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
function showResults(list) {
  let box = document.getElementById("results");
  box.innerHTML = "";
  if (list.length === 0) {
    box.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>";
    return;
  }

  list.forEach(item=>{
    box.innerHTML += `
      <div class="card">
        <h3>${item.name}</h3>
        <p class="version">Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${item.version}</p>
        <p class="version">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«: ${item.date}</p>
        <p>Ø§Ù„Ø­Ø¬Ù…: ${item.size || "-"}</p>
        <a href="${item.url}" target="_blank">â¬‡ ØªØ­Ù…ÙŠÙ„</a>
      </div>
    `;
  });
}
</script>
</body>
</html>



