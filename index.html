<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø³ÙŠÙØ±Ø§Øª</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8;--glass:rgba(255,255,255,0.04)}
    body{margin:0;background:linear-gradient(180deg,#071021 0%,#071a2a 100%);color:#e6eef6;
      font-family:"Segoe UI",Tahoma,"Noto Kufi Arabic",sans-serif;padding:28px;min-height:100vh}
    .container{max-width:950px;margin:auto}
    header{text-align:center;margin-bottom:20px}
    h1{margin:0;font-size:22px}
    .search-box{background:var(--card);padding:20px;border-radius:14px;
      box-shadow:0 8px 25px rgba(0,0,0,0.35)}
    .inputs{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    select,input[type=text]{padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.08);
      background:transparent;color:inherit;font-size:15px}
    select{min-width:160px}
    input[type=text]{flex:1;min-width:160px}
    button{background:var(--accent);border:none;padding:12px 16px;border-radius:10px;color:#012;
      cursor:pointer;transition:0.3s}
    button:hover{opacity:0.9}
    .results{margin-top:18px;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:14px}
    .result-item{background:var(--glass);backdrop-filter:blur(8px);padding:14px;border-radius:14px;
      text-align:center;cursor:pointer;transition:.2s}
    .result-item:hover{transform:translateY(-3px);border:1px solid rgba(6,182,212,0.3)}
    .thumb{width:100%;height:150px;border-radius:10px;overflow:hidden;background:#123;margin-bottom:10px}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .meta .name{font-weight:600;font-size:16px;margin-bottom:4px}
    .meta .small{font-size:13px;color:var(--muted)}
    .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);
      display:none;align-items:center;justify-content:center;z-index:1000;padding:10px}
    .overlay.show{display:flex}
    .card{background:var(--card);border-radius:16px;max-width:600px;width:100%;padding:20px;
      box-shadow:0 10px 30px rgba(0,0,0,0.4);position:relative;animation:fadeIn .4s}
    @keyframes fadeIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
    .close-btn{position:absolute;top:10px;left:14px;background:none;border:none;color:#fff;
      font-size:24px;font-weight:bold;cursor:pointer}
    .close-btn:hover{color:var(--accent)}
    .card-head{display:flex;gap:14px;align-items:center;flex-wrap:wrap;margin-top:30px}
    .big-thumb{width:200px;height:130px;border-radius:12px;overflow:hidden;flex-shrink:0;cursor:pointer}
    .big-thumb img{width:100%;height:100%;object-fit:cover}
    .info{flex:1}
    .info h2{margin:0 0 6px;font-size:20px}
    .details{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:14px}
    .detail{background:rgba(255,255,255,0.03);padding:10px;border-radius:10px;text-align:center}
    .detail b{display:block;margin-bottom:6px;color:var(--accent)}
    .actions{margin-top:14px;text-align:center;display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.1);padding:10px 16px;border-radius:10px;
      color:#fff;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:6px}
    .btn-ghost:hover{border-color:var(--accent);color:var(--accent)}
    .btn-ghost img{width:20px;height:20px}
  </style>
</head>
<body>
  <div class="container">
    <header><h1>ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø³ÙŠÙØ±Ø§Øª</h1></header>

    <section class="search-box">
      <div class="inputs">
        <select id="receiverType">
          <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
          <option value="starsat">StarSat</option>
          <option value="tiger">Tiger</option>
          <option value="senator">Senator</option>
        </select>
        <input id="searchBox" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø±Ø³ÙŠÙØ±..." autocomplete="off">
        <button id="clearBtn">Ù…Ø³Ø­</button>
      </div>
      <div id="results" class="results"></div>
    </section>
  </div>

  <div id="overlay" class="overlay">
    <div class="card">
      <button id="closeCard" class="close-btn">âœ–</button>
      <div class="card-head">
        <div class="big-thumb"><img id="cardImg"></div>
        <div class="info">
          <h2 id="cardName"></h2>
          <p id="cardSummary"></p>
        </div>
      </div>
      <div class="details">
        <div class="detail"><b>ÙŠØ¯Ø¹Ù… Ø´ÙŠØ±Ù†Ø¬</b><div id="cardShare"></div></div>
        <div class="detail"><b>Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ±ÙØ±</b><div id="cardServer"></div></div>
        <div class="detail"><b>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</b><div id="cardVersion"></div></div>
        <div class="detail"><b>ØªØ§Ø±ÙŠØ®</b><div id="cardDate"></div></div>
      </div>
      <div class="actions">
        <a id="downloadLink" class="btn-ghost" target="_blank">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ«</a>
        <button id="whatsappShare" class="btn-ghost">
          <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="ÙˆØ§ØªØ³Ø§Ø¨">Ù…Ø´Ø§Ø±ÙƒØ©
        </button>
      </div>
    </div>
  </div>

  <script>
    const typeSelect = document.getElementById('receiverType');
    const searchBox = document.getElementById('searchBox');
    const results = document.getElementById('results');
    const clearBtn = document.getElementById('clearBtn');
    const overlay = document.getElementById('overlay');
    const closeCard = document.getElementById('closeCard');
    const cardName = document.getElementById('cardName');
    const cardSummary = document.getElementById('cardSummary');
    const cardImg = document.getElementById('cardImg');
    const cardShare = document.getElementById('cardShare');
    const cardServer = document.getElementById('cardServer');
    const cardVersion = document.getElementById('cardVersion');
    const cardDate = document.getElementById('cardDate');
    const downloadLink = document.getElementById('downloadLink');
    const whatsappShare = document.getElementById('whatsappShare');
    const basePath = "https://github.com/falahsab/yoyosat/raw/refs/heads/main/csv/";

    let receivers = [];

    async function loadCSV(url) {
      const res = await fetch(url);
      const text = await res.text();
      const rows = text.trim().split(/\r?\n/).map(r=>r.split(','));
      const headers = rows.shift();
      return rows.map(r=>{
        const obj={};
        headers.forEach((h,i)=>obj[h.trim()]=r[i]?.trim());
        return obj;
      });
    }

    async function loadData(type) {
      receivers = [];
      results.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:12px;color:#aaa">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>`;
      try {
        if(type==="all"){
          const types=["starsat","tiger","senator"];
          const promises=types.map(t=>loadCSV(`${basePath}${t}.csv`).catch(()=>[]));
          const all=await Promise.all(promises);
          receivers = all.flat();
        }else{
          receivers = await loadCSV(`${basePath}${type}.csv`);
        }
        renderResults(receivers);
      }catch{
        results.innerHTML = `<div style="grid-column:1/-1;text-align:center;color:#888;padding:12px">âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>`;
      }
    }

    function renderResults(list) {
      results.innerHTML='';
      if(list.length===0){results.innerHTML='<div style="grid-column:1/-1;text-align:center;color:#888;padding:10px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';return;}
      list.forEach(r=>{
        const item=document.createElement('div');
        item.className='result-item';
        item.innerHTML=`<div class="thumb"><img src="${r.image||''}"></div>
        <div class="meta"><div class="name">${r.name}</div><div class="small">${r.server_type} â€¢ ${r.latest_version}</div></div>`;
        item.onclick=()=>showCard(r);
        results.appendChild(item);
      });
    }

    function showCard(r){
      cardName.textContent=r.name;
      cardSummary.textContent=`ÙŠØ¯Ø¹Ù… Ø´ÙŠØ±Ù†Ø¬: ${r.supports_sharing}`;
      cardImg.src=r.image;
      cardShare.textContent=r.supports_sharing;
      cardServer.textContent=r.server_type;
      cardVersion.textContent=r.latest_version;
      cardDate.textContent=r.latest_date;
      downloadLink.href=r.download;
      whatsappShare.onclick=()=>{
        const text=`ğŸ“º ${r.name}\nğŸ›°ï¸ Ø§Ù„Ø³ÙŠØ±ÙØ±: ${r.server_type}\nğŸ’¾ ${r.latest_version}\nğŸ“… ${r.latest_date}\nğŸ”— ${r.download}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`,'_blank');
      };
      overlay.classList.add('show');
    }

    closeCard.onclick=()=>overlay.classList.remove('show');
    overlay.onclick=e=>{if(e.target===overlay)overlay.classList.remove('show');}
    clearBtn.onclick=()=>{searchBox.value='';renderResults(receivers);}
    searchBox.oninput=()=>{
      const q=searchBox.value.trim().toLowerCase();
      const filtered=receivers.filter(r=>r.name.toLowerCase().includes(q));
      renderResults(filtered);
    };
    typeSelect.onchange=()=>loadData(typeSelect.value);

    // ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ
    loadData("all");
  </script>
</body>
</html>
